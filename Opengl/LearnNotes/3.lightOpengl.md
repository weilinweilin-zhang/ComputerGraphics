# 光照
## 颜色
### 一个着色器的生命周期
因为里面调用函数都直接拿gpu里面的数据，当有多个着色器的时候，怎么分别资源管理的呢

想必使用的时候，就用这个进行切换的吧
![ ](image-28.png)
回答:
``` 
glUseProgram 是不是把当前gpu资源切换成当前的着色器program，然后就可以调用不同着色器内部的参数
是的，`glUseProgram` 函数在OpenGL中确实起到了切换当前使用的着色器程序的作用。当你调用 `glUseProgram` 时，它会将指定的着色器程序设为当前活动的程序。从该调用开始，到下一个调用 `glUseProgram` 之前，所有的渲染调用将使用这个着色器程序。
一旦一个着色器程序被设置为当前活动程序，你就可以使用 OpenGL 提供的函数来设置这个程序中的uniform变量等参数。这包括但不限于：
- `glUniform1f`, `glUniform2f`, `glUniform3f`, `glUniform4f` 等，用于设置浮点类型的uniform变量。
- `glUniform1i`, `glUniform2i`, `glUniform3i`, `glUniform4i` 等，用于设置整数类型的uniform变量。
- `glUniformMatrix2fv`, `glUniformMatrix3fv`, `glUniformMatrix4fv` 等，用于设置矩阵类型的uniform变量。
- `glBindAttribLocation` 和 `glGetAttribLocation` 用于设置和获取attribute的位置。
```

### 光照颜色
也就是 光照的颜色，乘以当前物体的颜色，就是混合起来，并且作用于当前的物体就是结果色，但是后续应该还要考虑距离的问题
```
glm::vec3 lightColor(1.0f, 1.0f, 1.0f);
glm::vec3 toyColor(1.0f, 0.5f, 0.31f);
glm::vec3 result = lightColor * toyColor; // = (1.0f, 0.5f, 0.31f);
```

### phong 模型
phong 模型 包括环境光照，漫反射光照，镜面光照
#### 环境光照
Ambient Lighting)：即使在黑暗的情况下，世界上通常也仍然有一些光亮（月亮、远处的光），所以物体几乎永远不会是完全黑暗的。为了模拟这个，我们会使用一个环境光照常量，它永远会给物体一些颜色。
像代码里面直接就乘以一个外面的颜色值，就类似全局照明模型了。
（真正的全局照明算法 比较复杂 考虑到这种情况的算法叫做全局照明(Global Illumination)算法，但是这种算法既开销高昂又极其复杂。）

#### 漫反射光照
(Diffuse Lighting)：模拟光源对物体的方向性影响(Directional Impact)。它是风氏光照模型中视觉上最显著的分量。物体的某一部分越是正对着光源，它就会越亮
![alt text](image-29.png)

这个是入光的向量，和反射的向量呈现余弦值，所以两向量垂直的时候是没有光线的，两向量角度为0的时候，亮度最亮

漫反射的条件：
```
计算漫反射光照需要什么？
法向量：一个垂直于顶点表面的向量。
定向的光线：作为光源的位置与片段的位置之间向量差的方向向量。为了计算这个光线，我们需要光的位置向量和片段的位置向量。
```

##### 计算漫反射光照：(有疑问的点)
正常来说，在片段着色器里面只要颜色或者纹理就行，为什么在计算漫反射光照的时候要在片段着色器里面计算 这个model的坐标然后乘上这个片段着色器呢
![alt text](image-30.png)
![alt text](image-31.png)
估计的原因就是根据法向量，然后决定着fragment 片段着色器的 显示的分量，就是光照的亮度，然后不同颜色估计得，向量相乘（不是点×乘）就是计算分量，然后得出具体显示的颜色


法线计算，它直接在输入顶点的时候就把简单的法向量，直接输入进去了。
然后跟随着模式矩阵 旋转 位移等操作。
![alt text](image-32.png)


在顶点着色器里面获取 模型矩阵进行计算，为了在片段着色器 配合着法向量计算 光线的偏角度
![alt text](image-33.png)

* 步骤
```
 外部要传入 光源的位置，然后以及颜色,然后计算向量角度

光源坐标，怎么来的，怎么兼容他的旋转 （目前就写死一个向量坐标）

光源向量，就是光线位置减去当前顶点坐标的位置，然后点乘该顶点的法向量，计算出光照分量，

光照分量在加上环境光照 ，在成该点的颜色值，即可得出该点的最终颜色

光线向量和法向量 越向90趋势，那么光照越弱 因为cos 90 等于0

如果不乘上环境光的话，那么cos 大于90哪些光线分量就是黑色的，环境光线给点 颜色值而已
```
![alt text](image-34.png)

没有环境光线就是漆黑的一片
![alt text](image-35.png)
有环境光分量就更亮点
![alt text](image-36.png)
#### 镜面光照
Specular Lighting)：模拟有光泽物体上面出现的亮点。镜面光照的颜色相比于物体的颜色会更倾向于光的颜色。

